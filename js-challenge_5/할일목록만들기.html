<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ìï†Ïùº Î™©Î°ù</title>
    <style>
        @font-face {
            font-family: 'Dongle-Regular';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2108_2@1.0/Dongle-Regular.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        * {
            font-family: 'Dongle-Regular';
            box-sizing: border-box;
        }

        html {
            font-size: 23.79px;
        }

        body {
            margin: 0;
        }

        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .app {
            position: relative;
            width: 320px;
            height: 568px;
            border-radius: 16px;
            background-color: gray;
        }

        .app>h1 {
            font-size: 2em;
            text-align: center;
            margin: 10px 5px;
            border-bottom: 0.5px solid rgb(234, 234, 234);
        }

        ul {
            max-height: 420px;
            overflow: auto;
        }

        ul>li {
            cursor: pointer;
            position: relative;
            left: 60px;
            list-style-type: none;
            width: 200px;
            height: 40px;
            margin-bottom: 10px;
            padding: 6px;
            background-color: rgb(254, 229, 77);
            border-radius: 8px;
        }

        ul>li::after {
            content: "";
            position: absolute;
            top: 10px;
            right: -10px;
            width: 0;
            height: 0;
            border-bottom: 16px solid transparent;
            border-left: 16px solid rgb(254, 229, 77);
        }

        ul>li>span {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 16px;
            height: 16px;
            border-radius: 8px;
            background-color: rgb(234, 234, 234);
            position: absolute;
            left: -20px;
            bottom: 2px;
        }

        form {
            background-color: rgb(255, 255, 255);
            position: absolute;
            bottom: 0;
        }

        input {
            font-size: 1.4em;
            margin: 0;
            border: none;
            height: 45px;
        }

        input[type="text"] {
            width: 240px;
            padding-left: 10px;
        }

        input[type="text"]:focus {
            outline: none;
        }

        input[type="submit"] {
            cursor: pointer;
            width: 80px;
            border-radius: 8px;
            background-color: rgb(254, 229, 77);
        }

        .done {
            color: rgb(93, 93, 93);
            background-color: rgb(234, 234, 234);
        }

        .done::after {
            border-left: 16px solid rgb(234, 234, 234);
        }
    </style>
</head>

<body>

    <div id="container">
        <div class="app">
            <h1>üî•TO DO LISTüî•</h1>
            <ul id="todo-list"></ul>
            <form id="todo-form">
                <input name="todo" placeholder="ÏûÖÎ†•ÌïòÏÑ∏Ïöî." autocomplete="off">
                <input type="submit" value="Ï∂îÍ∞Ä">
            </form>
        </div>
    </div>

    <script>
        // ÏöîÏÜå ÏÑ†ÌÉù Î∞è Î∞∞Ïó¥ ÏÑ†Ïñ∏

        const todoList = document.getElementById("todo-list")
        const todoForm = document.getElementById("todo-form")
        let todoArr = [];

        // Î°úÏª¨ Ï†ÄÏû•ÏÜåÏóê Ï†ÄÏû•ÌïòÍ∏∞
        function saveTodos() {
            const todoString = JSON.stringify(todoArr)
            localStorage.setItem("myTodos", todoString)
        }

        // Î°úÏª¨ Ï†ÄÏû•ÏÜåÏóêÏÑú Í∞ÄÏ†∏Ïò§Í∏∞
        function loadTodos() {
            const myTodos = localStorage.getItem("myTodos")
            if (myTodos !== null) {
                todoArr = JSON.parse(myTodos)
                displayTodos()
            }
        }
        loadTodos()

        // Ìï†Ïùº ÏÇ≠Ï†úÌïòÍ∏∞
        function handleTodoDelBtnClick(clickedId) {
            todoArr = todoArr.filter(function (aTodo) {
                return aTodo.todoId !== clickedId
            })
            displayTodos()
            saveTodos()
        }

        // Ìï†Ïùº ÏàòÏ†ïÌïòÍ∏∞
        function handleTodoItemClick(clickedId) {
            todoArr = todoArr.map(function (aTodo) {
                if (aTodo.todoId === clickedId) {
                    return {
                        ...aTodo, todoDone: !aTodo.todoDone
                    }
                } else {
                    return aTodo
                }
            })
            displayTodos()
            saveTodos()

        }

        // Ìï†Ïùº Î≥¥Ïó¨Ï£ºÍ∏∞
        function displayTodos() {
            todoList.innerHTML = ""
            todoArr.forEach(function (aTodo) {
                const todoItem = document.createElement('li')
                const todoDelBtn = document.createElement('span')
                todoDelBtn.textContent = "x"
                todoItem.textContent = aTodo.todoText
                todoItem.title = "ÌÅ¥Î¶≠ Ïãú ÏôÑÎ£åÏ≤òÎ¶¨"
                if (aTodo.todoDone) {
                    todoItem.classList.add("done")
                } else {
                    todoItem.classList.add("yet")
                }
                todoDelBtn.title = "ÌÅ¥Î¶≠ Ïãú ÏÇ≠Ï†ú"

                todoItem.addEventListener("click", function () {
                    handleTodoItemClick(aTodo.todoId)
                })

                todoDelBtn.addEventListener("click", function () {
                    handleTodoDelBtnClick(aTodo.todoId)
                })

                todoItem.appendChild(todoDelBtn)
                todoList.appendChild(todoItem)
            })
        }

        // Ìï†Ïùº Ï∂îÍ∞ÄÌïòÍ∏∞
        todoForm.addEventListener("submit", function (e) {
            e.preventDefault()
            const toBeAdded = {
                todoText: todoForm.todo.value,
                todoId: new Date().getTime(),
                todoDone: false
            }
            todoForm.todo.value = ""
            todoArr.push(toBeAdded)
            displayTodos()
            saveTodos()
        })
    </script>
</body>

</html>